<?xml version="1.0"?>

<project name="ArchivesSpace" default="help">

  <target name="help" description="This help">
    <java classname="org.apache.tools.ant.Main">
      <arg value="-projecthelp" />
      <arg value="-buildfile" />
      <arg value="${ant.file}" />
    </java>
  </target>


  <target name="dist" description="Build a distribution jar">
    <mkdir dir="target" />

    <exec executable="javac" failonerror="true">
      <arg value="-d" />
      <arg value="target" />
      <arg value="-cp" />
      <arg value="libs/*" />
      <arg value="../src/org/archivesspace/Main.java" />
    </exec>

    <jar jarfile="deps.jar">
      <zipgroupfileset dir="libs" includes="*.jar" />
    </jar>

    <sleep seconds="1" />

    <jar jarfile="../archivesspace.jar" basedir="target">
      <zipfileset src="deps.jar" excludes="META-INF/*.SF" />

      <zipfileset src="../../backend/backend.war" prefix="backend" />
      <zipfileset src="../../frontend/frontend.war" prefix="frontend" />

      <manifest>
        <attribute name="Main-Class" value="org.archivesspace.Main" />
      </manifest>
    </jar>
  </target>

</project>
